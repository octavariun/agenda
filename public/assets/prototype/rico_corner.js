/**
  *
  *  Copyright 2005 Sabre Airline Solutions
  *
  *  Licensed under the Apache License, Version 2.0 (the "License"); you may not use this
  *  file except in compliance with the License. You may obtain a copy of the License at
  *
  *         http://www.apache.org/licenses/LICENSE-2.0
  *
  *  Unless required by applicable law or agreed to in writing, software distributed under the
  *  License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
  *  either express or implied. See the License for the specific language governing permissions
  *  and limitations under the License.
  **/
var Rico={Version:"1.1.0",prototypeVersion:parseFloat(Prototype.Version.split(".")[0]+"."+Prototype.Version.split(".")[1])};Rico.Color=Class.create(),Rico.Color.prototype={initialize:function(r,t,o){this.rgb={r:r,g:t,b:o}},blend:function(r){this.rgb.r=Math.floor((this.rgb.r+r.rgb.r)/2),this.rgb.g=Math.floor((this.rgb.g+r.rgb.g)/2),this.rgb.b=Math.floor((this.rgb.b+r.rgb.b)/2)},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}},Rico.Color.createFromHex=function(r){if(4==r.length)for(var t=r,r="#",o=1;4>o;o++)r+=t.charAt(o)+t.charAt(o);0==r.indexOf("#")&&(r=r.substring(1));var i=r.substring(0,2),e=r.substring(2,4),n=r.substring(4,6);return new Rico.Color(parseInt(i,16),parseInt(e,16),parseInt(n,16))},Rico.Color.createColorFromBackground=function(r){var t=$(r).getStyle("backgroundColor");if("transparent"==t&&r.parentNode)return Rico.Color.createColorFromBackground(r.parentNode);if(null==t)return new Rico.Color(255,255,255);if(0==t.indexOf("rgb(")){var o=t.substring(4,t.length-1),i=o.split(",");return new Rico.Color(parseInt(i[0]),parseInt(i[1]),parseInt(i[2]))}return 0==t.indexOf("#")?Rico.Color.createFromHex(t):new Rico.Color(255,255,255)},Rico.Color.HSBtoRGB=function(r,t,o){var i=Math.round(255*(o/100));if(0==this[1])return[i,i,i];var r=this[0]%360,e=r%60,n=Math.round(255*(o*(100-t)/1e4)),s=Math.round(255*(o*(6e3-t*e)/6e5)),h=Math.round(255*(o*(6e3-t*(60-e))/6e5));switch(Math.floor(r/60)){case 0:return{r:i,g:h,b:n};case 1:return{r:s,g:i,b:n};case 2:return{r:n,g:i,b:h};case 3:return{r:n,g:s,b:i};case 4:return{r:h,g:n,b:i};case 5:return{r:i,g:n,b:s}}return!1},Rico.Color.RGBtoHSB=function(r,t,o){var i,e,n,s=Math.max(r,t,o),h=Math.min(r,t,o),a=s-h;if(n=s/255,e=0!=s?a/s:0,0==e)i=0;else{var d=(s-r)/a,c=(s-t)/a,l=(s-o)/a;i=r==s?l-c:t==s?2+d-l:4+c-d,i/=6,0>i&&i++}return{h:Math.round(360*i),s:Math.round(100*e),b:Math.round(100*n)}},Rico.Corner={round:function(r,t){var r=$(r);this._setOptions(t);var o=this.options.color;"fromElement"==this.options.color&&(o=this._background(r));var i=this.options.bgColor;"fromParent"==this.options.bgColor&&(i=this._background(r.offsetParent)),this._roundCornersImpl(r,o,i)},_roundCornersImpl:function(r,t,o){this.options.border&&this._renderBorder(r,o),this._isTopRounded()&&this._roundTopCorners(r,t,o),this._isBottomRounded()&&this._roundBottomCorners(r,t,o)},_renderBorder:function(r,t){var o="1px solid "+this._borderColor(t),i="border-left: "+o,e="border-right: "+o,n="style='"+i+";"+e+"'";r.innerHTML="<div "+n+">"+r.innerHTML+"</div>"},_roundTopCorners:function(r,t,o){for(var i=this._createCorner(o),e=0;this.options.numSlices>e;e++)i.appendChild(this._createCornerSlice(t,o,e,"top"));r.style.paddingTop=0,r.insertBefore(i,r.firstChild)},_roundBottomCorners:function(r,t,o){for(var i=this._createCorner(o),e=this.options.numSlices-1;e>=0;e--)i.appendChild(this._createCornerSlice(t,o,e,"bottom"));r.style.paddingBottom=0,r.appendChild(i)},_createCorner:function(r){var t=document.createElement("div");return t.style.backgroundColor=this._isTransparent()?"transparent":r,t},_createCornerSlice:function(r,t,o,i){var e=document.createElement("span"),n=e.style;n.backgroundColor=r,n.display="block",n.height="1px",n.overflow="hidden",n.fontSize="1px";var s=this._borderColor(r,t);return this.options.border&&0==o?(n.borderTopStyle="solid",n.borderTopWidth="1px",n.borderLeftWidth="0px",n.borderRightWidth="0px",n.borderBottomWidth="0px",n.height="0px",n.borderColor=s):s&&(n.borderColor=s,n.borderStyle="solid",n.borderWidth="0px 1px"),this.options.compact||o!=this.options.numSlices-1||(n.height="2px"),this._setMargin(e,o,i),this._setBorder(e,o,i),e},_setOptions:function(r){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1},Object.extend(this.options,r||{}),this.options.numSlices=this.options.compact?2:4,this._isTransparent()&&(this.options.blend=!1)},_whichSideTop:function(){return this._hasString(this.options.corners,"all","top")?"":this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0?"":this.options.corners.indexOf("tl")>=0?"left":this.options.corners.indexOf("tr")>=0?"right":""},_whichSideBottom:function(){return this._hasString(this.options.corners,"all","bottom")?"":this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0?"":this.options.corners.indexOf("bl")>=0?"left":this.options.corners.indexOf("br")>=0?"right":""},_borderColor:function(r,t){return"transparent"==r?t:this.options.border?this.options.border:this.options.blend?this._blend(t,r):""},_setMargin:function(r,t,o){var i=this._marginSize(t),e="top"==o?this._whichSideTop():this._whichSideBottom();"left"==e?(r.style.marginLeft=i+"px",r.style.marginRight="0px"):"right"==e?(r.style.marginRight=i+"px",r.style.marginLeft="0px"):(r.style.marginLeft=i+"px",r.style.marginRight=i+"px")},_setBorder:function(r,t,o){var i=this._borderSize(t),e="top"==o?this._whichSideTop():this._whichSideBottom();"left"==e?(r.style.borderLeftWidth=i+"px",r.style.borderRightWidth="0px"):"right"==e?(r.style.borderRightWidth=i+"px",r.style.borderLeftWidth="0px"):(r.style.borderLeftWidth=i+"px",r.style.borderRightWidth=i+"px"),0!=this.options.border&&(r.style.borderLeftWidth=i+"px"),r.style.borderRightWidth=i+"px"},_marginSize:function(r){if(this._isTransparent())return 0;var t=[5,3,2,1],o=[3,2,1,0],i=[2,1],e=[1,0];return this.options.compact&&this.options.blend?e[r]:this.options.compact?i[r]:this.options.blend?o[r]:t[r]},_borderSize:function(r){var t=[5,3,2,1],o=[2,1,1,1],i=[1,0],e=[0,2,0,0];return this.options.compact&&(this.options.blend||this._isTransparent())?1:this.options.compact?i[r]:this.options.blend?o[r]:this.options.border?e[r]:this._isTransparent()?t[r]:0},_hasString:function(r){for(var t=1;arguments.length>t;t++)if(r.indexOf(arguments[t])>=0)return!0;return!1},_blend:function(r,t){var o=Rico.Color.createFromHex(r);return o.blend(Rico.Color.createFromHex(t)),o},_background:function(r){try{return Rico.Color.createColorFromBackground(r).asHex()}catch(t){return"#ffffff"}},_isTransparent:function(){return"transparent"==this.options.color},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(r){return 1==r.childNodes.length&&3==r.childNodes[0].nodeType}};